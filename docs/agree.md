# 君子协定

## 版本号约定

版本号由三个数字(`X.Y.Z`)构成，分别表示主版本号、次版本号、修订号，版本号递增规则如下：

- 主版本号：当你做了不兼容旧版的修改递增此版本号
- 次版本号：当你做了向下兼容的功能性新增递增此版本号
- 修订号：当你做了向下兼容的问题修正递增此版本号

## 引入依赖

### 引入源码依赖

通过`cup install <url|unique>` 命令可以将依赖安装至本地，在项目中添加以下代码即可使用依赖项：
```toml
[dependencies]
dep = { git = "<url|unique>" }
```

## 引入二进制文件依赖

将二进制文件依赖项存储在项目下的包存储目录(通常是`package`或`packages`文件夹)
在`cup.toml`文件中通过`build.include`指定头文件目录，通过`[link]`指定链接库
并通过`build.generator`指定生成器名称，它应与依赖项的构建系统匹配

**对于链接库项目，建议将所依赖的链接库文件一同发布**

## 发布依赖

建议在发布的依赖中添加Doxygen文档，以便于使用方查阅接口文档

### 通过源码发布
将源码发布到公共仓库，以 Github 为例，发布流程如下：
1. 确保代码可以编译及测试通过
2. 在 Github 上创建一个新的仓库或使用其代码的原有仓库，并将代码上传到仓库
3. 单独创建一个仅存在极少量更改(通常是更改版本号)的新更改存档记录将其的 commit 记录为`Publish(vX.Y.Z): ...`
4. 从刚才创建的新更改记录中创建一个发行版，发行版标签应符合`vX.Y.Z`格式且应与版本号一致

当通过`cup install`命令安装依赖时，cup会检索相关的发行版标签，默认其格式为`'v'+<version>`

### 以二进制文件发布

+ 对于可执行程序，只需将编译出的二进制可执行文件及其环境依赖项一同打包发布即可
+ 对于链接库文件，应明确指出其是通过哪个生成器构建的，并提供相应的头文件接口文件

**出于代码的通用性考虑，不建议将链接库代码以二进制形式发布**